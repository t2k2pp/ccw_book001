# 第1章: プロンプト手法解説

この章では、効果的なプロンプトを作成するための主要な手法を体系的に解説します。
各手法の原理、使用場面、メリット・デメリットを理解することで、状況に応じた最適なプロンプトを設計できるようになります。

---

## 1.1 基本原則：良いプロンプトの3要素

効果的なプロンプトには、以下の3つの要素が含まれます。

### 1. **明確な指示（What）**
何をしてほしいのかを具体的に記述します。

```
悪い例：「このコードを良くして」
良い例：「このPython関数のパフォーマンスを改善し、実行時間を短縮してください」
```

### 2. **文脈の提供（Why/Context）**
なぜその作業が必要か、どんな背景があるかを伝えます。

```
「顧客向けのAPI仕様書として使用するため、技術的な詳細は残しつつ、
 専門用語には説明を加えてください」
```

### 3. **出力形式の指定（How）**
どんな形式で答えてほしいかを明示します。

```
「箇条書きで3つの改善案を提示し、各案のメリット・デメリットを
 表形式でまとめてください」
```

---

## 1.2 Zero-shot Prompting（ゼロショット）

### 概要
例を示さずに、指示だけで回答を求める最もシンプルな手法です。

### 適用場面
- 一般的な質問や明確なタスク
- モデルが十分な知識を持っている領域
- 迅速な回答が必要な場合

### メリット
- シンプルで簡潔
- プロンプトが短く、トークン消費が少ない
- 迅速に結果が得られる

### デメリット
- 複雑なタスクでは精度が低下
- 出力形式が不安定になりがち
- 期待と異なる解釈をされる可能性

### 例
```
プロンプト：
「TypeScriptでHTTPリクエストを送信する関数を作成してください」
```

### 推奨モデル
- GPT-4o, Claude 3.5 Sonnet等の最新モデル全般
- 単純なタスクであれば古いモデルでも有効

### 非推奨ケース
- 特定の形式や詳細な要件がある場合
- 専門的・複雑なタスク

---

## 1.3 Few-shot Prompting（フューショット）

### 概要
複数の入力例と期待する出力例を示すことで、AIに「パターン」を学習させる手法です。

### 適用場面
- 特定の形式で出力してほしい場合
- AIが理解しにくい独自のルールやスタイルがある場合
- 一貫性のある複数の出力を得たい場合

### メリット
- 出力形式を精密にコントロールできる
- 複雑なパターンも学習可能
- 一貫性の高い結果が得られる

### デメリット
- プロンプトが長くなる（トークン消費増加）
- 例の選び方で結果が大きく変わる
- 例を作成する手間がかかる

### 例
```
プロンプト：
「以下の例に従って、商品レビューの感情分析を行ってください。

例1:
入力: 「商品は期待通りで満足しています」
出力: ポジティブ（スコア: 8/10）

例2:
入力: 「配送が遅れたが商品自体は良い」
出力: 中立（スコア: 6/10）

例3:
入力: 「不良品でした。返品します」
出力: ネガティブ（スコア: 2/10）

では、以下のレビューを分析してください：
入力: 「価格の割に品質が良く、コスパ最高です」
出力: 」
```

### 推奨モデル
- GPT-4o, Claude 3.5 Sonnet等の最新モデル
- パターン認識が得意なモデル

### 非推奨ケース
- o1等の推論特化モデル（既にCoT的思考を内部で行うため、例は不要な場合が多い）
- トークン制限が厳しい環境

---

## 1.4 Chain-of-Thought (CoT) Prompting（思考連鎖）

### 概要
「段階的に考えるプロセス」を明示することで、複雑な推論タスクの精度を向上させる手法です。

### 適用場面
- 数学的計算や論理的推論
- 複数ステップを要する問題解決
- 意思決定プロセスの可視化が必要な場合

### メリット
- 複雑な問題でも正確な回答が得られる
- 推論過程が可視化され、検証可能
- エラーの原因を特定しやすい

### デメリット
- 出力が長くなる
- 単純なタスクではオーバーヘッド
- 推論時間が長くなる

### 例
```
プロンプト：
「以下の問題を段階的に解いてください。

問題: ある店で、リンゴは1個150円、ミカンは1個100円です。
リンゴ3個とミカン5個を買った場合、合計金額はいくらですか？
ただし、1000円以上の購入で10%割引が適用されます。

ステップ1: リンゴの合計金額を計算
ステップ2: ミカンの合計金額を計算
ステップ3: 合計金額を計算
ステップ4: 割引の適用有無を判定
ステップ5: 最終金額を計算

それでは、解いてください。」
```

### 推奨モデル
- GPT-4o, Claude 3.5 Sonnet等の最新モデル
- 複雑な推論が必要な場合に特に有効

### 非推奨ケース
- **o1, o3-mini等の推論特化モデル**（内部で自動的にCoTを実行するため、明示的な指示は不要。逆に制約となる可能性あり）
- 単純な事実確認タスク

---

## 1.5 Role Prompting（役割設定）

### 概要
AIに特定の「役割」や「専門性」を与えることで、その視点から回答させる手法です。

### 適用場面
- 専門的な知識が必要な場合
- 特定の立場からの意見が欲しい場合
- 文体やトーンを調整したい場合

### メリット
- 専門的で質の高い回答が得られる
- 文体・トーンのコントロールが容易
- 複数の視点を得ることが可能

### デメリット
- 役割設定が不適切だと効果なし
- 過度に専門的になりすぎる可能性
- 役割に固執しすぎることもある

### 例
```
プロンプト：
「あなたは20年のキャリアを持つベテランのセキュリティエンジニアです。
以下のコードにセキュリティ上の問題がないかレビューし、
具体的な改善案を提示してください。

[コード]
」
```

### 推奨モデル
- 全モデルで有効
- 特にClaude系はロールプレイが得意

### 非推奨ケース
- 事実確認のみのタスク（役割は不要）
- 客観性が求められる場合

---

## 1.6 Self-Consistency（自己一貫性）

### 概要
同じ問題に対して複数回推論を行い、最も多く得られた答えを採用する手法です。

### 適用場面
- 正確性が重要な計算タスク
- 複数の解決策を比較したい場合
- 信頼性の高い回答が必要な場合

### メリット
- 精度が大幅に向上
- ランダム性によるエラーを低減
- 複数の視点から検証できる

### デメリット
- 計算コストが高い（複数回実行）
- 時間がかかる
- トークン消費が増加

### 例
```
プロンプト：
「以下の問題を3つの異なるアプローチで解き、
それぞれの結果を比較してください。

問題: [複雑な数学問題]

アプローチ1: 代数的解法
アプローチ2: グラフ的解法
アプローチ3: 数値的解法

最後に、3つの結果が一致するか確認し、
最も信頼できる答えを提示してください。」
```

### 推奨モデル
- 推論能力の高いモデル（GPT-4o, o1, Claude 3.5 Sonnet）
- 複雑な問題に対して特に有効

### 非推奨ケース
- 単純なタスク（オーバーキル）
- リアルタイム応答が必要な場面

---

## 1.7 Tree of Thoughts (ToT)（思考の木）

### 概要
複数の思考経路を「木構造」として展開し、各分岐を評価しながら最適な解を探索する手法です。

### 適用場面
- 複数の選択肢があるゲームや戦略立案
- 創造的な問題解決
- 最適化が必要な複雑なタスク

### メリット
- 複雑な問題に対する最適解を見つけやすい
- 探索過程が可視化される
- 失敗した経路からも学習できる

### デメリット
- 非常に計算コストが高い
- プロンプトが複雑になる
- 実装が難しい

### 例
```
プロンプト：
「以下の問題を解くために、複数の戦略を木構造で展開してください。

問題: 新規事業の立ち上げにあたり、限られた予算で最大の効果を得る方法

ステップ1: 考えられる戦略を3つ挙げる
ステップ2: 各戦略から派生する具体的な施策を3つずつ挙げる
ステップ3: 各施策のコスト・効果・リスクを評価（1-10点）
ステップ4: 評価が高い経路を選択し、実行計画を立てる

思考の木を展開してください。」
```

### 推奨モデル
- o1, GPT-4o等の高性能モデル
- 長文生成に強いモデル

### 非推奨ケース
- 単純な意思決定タスク
- リアルタイム応答が必要な場面
- 古いモデル（処理能力不足）

---

## 1.8 Retrieval Augmented Generation (RAG)（検索拡張生成）

### 概要
外部データベースやドキュメントから関連情報を検索し、それを基に回答を生成する手法です。

### 適用場面
- 最新情報や固有の知識が必要な場合
- 社内文書やマニュアルを基にした回答
- ハルシネーション（幻覚）を防ぎたい場合

### メリット
- 最新情報や固有知識に対応可能
- 情報源が明確で検証可能
- ハルシネーションを大幅に削減

### デメリット
- 外部システムとの連携が必要
- 検索精度に依存
- セットアップが複雑

### 例
```
プロンプト（APIやツール経由）：
「以下の社内規定文書を参照して、年次有給休暇の取得ルールを説明してください。

[検索結果: 社内規定第3章 第12条...]

上記の情報を基に、わかりやすく説明してください。」
```

### 推奨モデル
- API経由でドキュメントを渡せる全モデル
- Claude（Projects機能）, ChatGPT（GPTs）
- NotebookLM（Google）が特に優秀

### 非推奨ケース
- 一般的な知識のみで回答できるタスク
- 外部情報が不要な場合

---

## 1.9 Prompt Chaining（プロンプト連鎖）

### 概要
複数のプロンプトを連鎖的に実行し、前のステップの出力を次の入力として使用する手法です。

### 適用場面
- 大規模なタスクを段階的に処理
- 各ステップで異なる専門性が必要な場合
- ワークフローの自動化

### メリット
- 複雑なタスクを管理しやすい単位に分割
- 各ステップで専門性を変更可能
- エラー箇所の特定が容易

### デメリット
- 手動での連鎖は手間がかかる
- 中間出力の品質が最終結果に影響
- 全体の実行時間が長くなる

### 例
```
ステップ1:
「以下の顧客レビューから、主要な問題点を3つ抽出してください。
[レビューデータ]」

ステップ2（ステップ1の出力を使用）:
「以下の問題点それぞれに対して、改善案を提案してください。
[ステップ1の出力]」

ステップ3（ステップ2の出力を使用）:
「以下の改善案を実行する際の優先順位を、コスト・効果・実現可能性の
観点から評価してください。
[ステップ2の出力]」
```

### 推奨モデル
- 全モデルで有効
- API経由での自動化が推奨（Dify, n8n等）

### 非推奨ケース
- 単一のプロンプトで完結するタスク
- リアルタイム応答が必要な場面

---

## 1.10 Negative Prompting（否定的プロンプト）

### 概要
「やってほしくないこと」を明示することで、不要な出力を防ぐ手法です。

### 適用場面
- 特定のスタイルや表現を避けたい場合
- 不適切な内容を防ぎたい場合
- 出力の制約を明確にしたい場合

### メリット
- 不要な出力を効果的に防げる
- 意図しない解釈を減らせる
- 出力品質を安定化

### デメリット
- 否定ばかりだとAIが混乱する可能性
- ポジティブな指示と併用が必須
- 過度な制約は創造性を損なう

### 例
```
プロンプト：
「技術ブログ記事を作成してください。

要件:
- 初心者にもわかりやすく説明する
- コード例を含める
- 実践的な内容にする

避けるべき点:
- 専門用語の羅列
- 「簡単です」「すぐにできます」などの曖昧な表現
- 抽象的な概念説明のみ
- 過度に長い前置き」
```

### 推奨モデル
- 全モデルで有効
- 特に創作系タスクで効果的

### 非推奨ケース
- ポジティブな指示が不明確な場合
- 否定のみのプロンプト

---

## 1.11 Constraint Prompting（制約付きプロンプト）

### 概要
出力に対して明確な制約（文字数、形式、条件等）を設けることで、期待する結果を得る手法です。

### 適用場面
- 文字数制限がある文書作成
- 特定のフォーマットが必要な場合
- 条件を満たす必要がある場合

### メリット
- 出力を精密にコントロール可能
- 要件を満たす結果が得られる
- 後処理の手間を削減

### デメリット
- 制約が厳しすぎると品質低下
- 創造性が制限される可能性
- 制約の矛盾に注意が必要

### 例
```
プロンプト：
「新製品のキャッチコピーを作成してください。

制約条件:
- 文字数: 15文字以内
- ひらがな・カタカナ・漢字のみ（記号不可）
- 商品名「スマートクリーン」を含める
- ポジティブなイメージを与える
- 韻を踏む（任意）

5つの候補を提案してください。」
```

### 推奨モデル
- 全モデルで有効
- 制約が複雑な場合は最新モデルが推奨

### 非推奨ケース
- 自由な発想が必要な創作タスク
- 制約が不明確な場合

---

## 1.12 Meta Prompting（メタプロンプト）

### 概要
AIに「最適なプロンプトを生成させる」手法。AIをプロンプト設計のアシスタントとして活用します。

### 適用場面
- 効果的なプロンプトの作り方がわからない場合
- タスクに最適なプロンプト構造を探りたい場合
- プロンプトの改善提案が欲しい場合

### メリット
- プロンプト設計の負担を軽減
- 自分では思いつかない視点を得られる
- 継続的な改善が可能

### デメリット
- 初心者には抽象度が高い
- 生成されたプロンプトの評価が必要
- 2段階のやり取りが必要

### 例
```
プロンプト：
「私は、顧客からの問い合わせメールに対する返信文を自動生成したいと考えています。
以下の要件を満たす最適なプロンプトを設計してください。

要件:
- 丁寧でありながらフレンドリーなトーン
- 問い合わせ内容を正確に理解し、適切に回答
- 必要に応じて次のステップを案内
- テンプレート的でなく、個別対応感を出す

設計したプロンプトとその使用例を提示してください。」
```

### 推奨モデル
- GPT-4o, Claude 3.5 Sonnet等の最新モデル
- プロンプトエンジニアリングの知識を持つモデル

### 非推奨ケース
- 既に最適なプロンプトが明確な場合
- 単純なタスク

---

## 1.13 Iterative Refinement（反復改善）

### 概要
AIの出力を受け取り、それに対してフィードバックを与えながら徐々に完成度を高めていく手法です。

### 適用場面
- 創作物の作成（文章、コード、デザイン案等）
- 一発で完璧な出力が難しい複雑なタスク
- 段階的にブラッシュアップしたい場合

### メリット
- 最終的な品質が高い
- 柔軟な調整が可能
- AIと協働する感覚で作業できる

### デメリット
- 時間とトークンを多く消費
- 何度もやり取りする手間
- 明確なゴールがないと収束しない

### 例
```
第1ラウンド:
「マーケティングメールの件名を5つ提案してください。」

第2ラウンド（AIの出力を見て）:
「2番目と4番目の案を組み合わせて、もっと緊急性を感じる表現にしてください。」

第3ラウンド:
「良くなりました。さらに数字を入れて具体性を高めてください。」
```

### 推奨モデル
- 全モデルで有効
- 対話的なやり取りが得意なClaude系が特に優秀

### 非推奨ケース
- 迅速な回答が必要な場面
- 厳密な要件が最初から明確な場合

---

## 1.14 Persona-based Prompting（ペルソナベース）

### 概要
ターゲットユーザーのペルソナ（年齢、職業、関心事等）を設定し、その視点に合わせた出力を得る手法です。

### 適用場面
- マーケティングコンテンツの作成
- ターゲット層に合わせた文書作成
- ユーザー視点でのレビューが欲しい場合

### メリット
- ターゲットに刺さる内容を生成
- 複数のペルソナで比較可能
- ユーザー視点を反映しやすい

### デメリット
- ペルソナ設定が不適切だと効果なし
- 偏った視点になる可能性
- ペルソナごとに複数回実行が必要

### 例
```
プロンプト：
「以下のペルソナになりきって、新しいタスク管理アプリを評価してください。

ペルソナ:
- 名前: 田中太郎（35歳）
- 職業: IT企業のプロジェクトマネージャー
- 課題: 複数プロジェクトの進捗管理に苦労している
- ITリテラシー: 高い
- 価値観: 効率性重視、シンプルなUIを好む

上記の視点から、このアプリの良い点と改善点を5つずつ挙げてください。」
```

### 推奨モデル
- 全モデルで有効
- 特にロールプレイが得意なClaude系

### 非推奨ケース
- 客観的な評価が必要な場合
- 技術的な正確性が最優先の場合

---

## まとめ：手法選択のフローチャート

```
タスクの性質
│
├─ 単純・明確 → Zero-shot Prompting
│
├─ 特定の形式が必要 → Few-shot Prompting
│
├─ 複雑な推論が必要
│  ├─ 通常モデル → Chain-of-Thought
│  └─ 推論特化モデル（o1等） → シンプルな指示（CoT不要）
│
├─ 専門性が必要 → Role Prompting
│
├─ 創造的な発想が必要 → Tree of Thoughts
│
├─ 最新情報・固有知識が必要 → RAG
│
├─ 大規模タスク → Prompt Chaining
│
├─ 制約が明確 → Constraint Prompting
│
├─ 段階的改善 → Iterative Refinement
│
└─ ターゲット視点 → Persona-based Prompting
```

---

## 次章以降の構成

第2章以降では、これらの手法を実際にどう活用するかを、**具体的なシーン別プロンプト例**で解説します。

各プロンプト例には以下を明記：
- **使用手法**：どの手法を使っているか
- **期待する効果**：何が得られるか
- **推奨/非推奨モデル**：最適な使用環境

それでは、実践編に進みましょう！
